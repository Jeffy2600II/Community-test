<header class="site-header" role="banner">
  <div class="container header-inner">
    <!-- Top row: logo + mobile toggle -->
    <div class="header-top" role="presentation">
      <a class="logo" href="/" aria-label="COMMUNITY home">
        <svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden="true" class="logo-mark" focusable="false">
          <rect width="24" height="24" rx="6" fill="#2f80ed"></rect>
          <path d="M7 13h10M7 9h10" stroke="#fff" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
        <div class="brand-wrap" aria-hidden="true">
          <div class="brand">COMMUNITY</div>
          <div class="tagline">พื้นที่แลกเปลี่ยนความรู้</div>
        </div>
      </a>

      <!-- Mobile menu toggle: now controls the right-side mobile drawer -->
      <button id="mobileMenuToggle" class="btn btn-icon" aria-expanded="false" aria-controls="mobileSidebar" aria-label="Toggle menu">
        <!-- simple hamburger icon -->
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#1f2a37" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M4 7h16M4 12h16M4 17h16"></path>
        </svg>
      </button>
    </div>

    <!-- Bottom row: search + dynamic nav/actions (kept for tablet/desktop)
         On mobile this element will be hidden (we use the right-side drawer instead). -->
    <div id="headerBottom" class="header-bottom" role="navigation" aria-label="Site actions">
      <div class="header-search" role="search" aria-label="Site search">
        <form onsubmit="event.preventDefault(); const q=this.query.value.trim(); if(q) location.href='/search?q='+encodeURIComponent(q);">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.35-4.35" stroke="#97a0b3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
          <input type="search" name="query" placeholder="ค้นหาบทความ ผู้ใช้งาน หรือแท็ก" aria-label="ค้นหา">
        </form>
      </div>

      <!-- navBar is populated by JS (accounts/actions/notifications) -->
      <div id="navBar" class="header-actions" aria-hidden="false"></div>
    </div>
  </div>

  <!-- Right-side mobile drawer (new/explicit element)
       - This drawer will be used on small screens (<=800px)
       - The mobileMenuToggle button now targets this element.
       - Content (navBar) will be moved into #mobileNavContainer on small screens by JS. -->
  <div id="mobileSidebar" class="mobile-drawer" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="mobile-drawer-inner">
      <div class="mobile-drawer-header" style="display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid rgba(15,23,42,0.04);">
        <div style="display:flex;align-items:center;gap:10px;">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true"><rect width="24" height="24" rx="6" fill="#2f80ed"></rect></svg>
          <div style="font-weight:700">เมนู</div>
        </div>
        <button id="mobileSidebarClose" class="btn btn-ghost" aria-label="ปิดเมนู">✕</button>
      </div>
      <div id="mobileNavContainer" class="mobile-nav-container" style="padding:12px; overflow:auto;"></div>
    </div>
  </div>
</header>